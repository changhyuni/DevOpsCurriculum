# Quest 17. 서비스의 운영 (1): 서버 들여다 보기

## Introduction
* 이번 퀘스트에서는 서비스 운영을 위한 리눅스 커맨드와 모니터링에 대해 다루겠습니다.

## Topics
* 리눅스의 커맨드들: `lsof`, `df`, `top`, `free`, `nmon`, `iostat`, `ifconfig`, `crontab`
* Cloudwatch
* Grafana

## Resources
* https://www.tecmint.com/command-line-tools-to-monitor-linux-performance/
* https://docs.aws.amazon.com/ko_kr/AmazonCloudWatch/latest/monitoring/working_with_metrics.html
* https://grafana.com/docs/grafana/latest/getting-started/getting-started/

## Checklist
* 위 Topics의 리눅스 커맨드들은 어떤 커맨드인가요? 운영 중 어떤 상황에 쓸 수 있을까요?  
* Cloudwatch는 어떤 서비스인가요? 우리가 구축한 시스템 관련하여, Cloudwatch에서 제공하는 메트릭들 중 유용한 것은 어떤 것이 있을까요?  
  
  Cloudwatch는 AWS 리소스에대한 통합적인 모니터링 서비스로 통합적인 뷰를 확보하는데 필요한 데이터를 제공합니다. 또한, 이벤트 및 리소스를 이용해 경보를 만들 수 도 있습니다. 
  정기적인 일정으로 trigger되는 규칙을 만들어서 특정 시간에 리소스 삭제나 빌드 및 배포 방식을 사용할 수 있습니다. Logs기능으로 운영 중인 애플리케이션의 리소스를 기록하고 엑세스 할 수 있으며
  로그데이터를 검색할 수도 있습니다. 커스텀 메트릭을 만들어 사용할 수도 있고 AWS에서 제공하는 메트릭을 사용할 수도 있습니다.  
  현재 시스템에서는 각 서비스별로 제공하는 CPUUililzation, Networkin, Networkout, DiskReadBytes 등 장애와 밀접한 메트릭을 수집하여 확인 할 수있습니다. 

* Grafana는 어떤 역할을 하는 툴인가요? Grafana 외에 비슷한 일을 하는 툴은 무엇이 있을까요?  

  그라파나는 시각화 도구로 가져온 메트릭 데이터들을 시각화 화고 메트릭에 맞게 대시보드를 구성할 수 있다는 점에서 비슷한 특징을 가지고 있습니다.  
  그라파나와 가장 양대산맥은 소프트웨어는 데이터독(Datadog)이 있습니다. 모니터링 서비스로 서버와 클라우드 서비스에 대한 로그 수집, 네트워크, 대시보드, 알람등 다양한 모니터링 기능들을 제공하고 있습니다.  

  가장 큰 차이점은 데이터독의 경우 데이터를 직접 저장하고 있는 것과 달리 그라파나는 외부 데이터 소스를 정의하고 해당 데이터 소스에 쿼리를 통해서 데이터를 동적으로 가지고 와서 시각화를 한다는 점입니다. 예를 들어,
  데이터독에서 AWS 서비스를 연동하면 클라우드 와치의 메트릭 데이터를 일정 주기로 가져와서 데이터독 데이터베이스에 저장해둡니다. 이 때문에 데이터독을 사용하느 경우 클라우드 와치의 실시간 데이터와 15분정도의 약간의 시차가 발생합니다.
  반면에 그라파나는 AWS 클라우드 와치의 직접 쿼리해서 데이터를 가져오기 때문에 대시보드를 조회하는 동안 최신 데이터를 확인할 수 있습니다. 데이터독은 모니터링 서비스를 제공하는 상용 서비스이고, 그라파나는 오픈소스 프로젝트입니다. 데이터독과 비교하기에 좀 더 적절한 서비스는 그라파나 자체보다는 그라파나 클라우드 서비스라고 할 수 있습니다. 
  그라파나 클라우드에서는 메트릭(프로메테우스)과 로그 데이터(로키)를 저장하고 사용할 수 있습니다.
  

## Quest
* 리눅스 시스템의 모니터링이나 상태 파악을 위한 커맨드를 연습해 보세요.
* Grafana를 통해 지금까지 구축한 전체 시스템에 대한 모니터링 페이지를 구축해 보세요.
* 서버가 비정상 상태일 때, 혹은 서버의 대수에 변화가 있을 때 운영자가 알 수 있도록 슬랙을 통해 Alert을 설정해 보세요.
